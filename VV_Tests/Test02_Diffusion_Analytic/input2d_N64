// Test 2: Pure Diffusion - Coarse Grid (N=64)
MU = 1.0e-2
RHO = 1.0
KAPPA = 0.01  // Diffusion coefficient α

MAX_LEVELS = 1
N = 64

START_TIME = 0.0
END_TIME = 1.0
DT_MAX = 0.001
CFL_MAX = 0.5

Main {
   log_file_name = "test02_N64.log"
   viz_writer = "VisIt"
   viz_dump_interval = 10
   viz_dump_dirname = "viz_test02_N64"
}

CartesianGeometry {
   domain_boxes = [(0,0), (N-1, N-1)]
   x_lo = -5.0, -5.0
   x_up =  5.0,  5.0
   periodic_dimension = 0, 0
}

GriddingAlgorithm {
   max_levels = MAX_LEVELS
   largest_patch_size { level_0 = 512, 512 }
   smallest_patch_size { level_0 = 8, 8 }
}

StandardTagAndInitialize { tagging_method = "GRADIENT_DETECTOR" }
LoadBalancer { bin_pack_method = "SPATIAL" }

INSStaggeredHierarchyIntegrator {
   mu = MU
   rho = RHO
   start_time = START_TIME
   end_time = END_TIME
   cfl = CFL_MAX
   dt_max = DT_MAX
   enable_logging = TRUE
}

VelocityBcCoefs_0 {
   acoef_function_0 = "1.0"
   acoef_function_1 = "1.0"
   acoef_function_2 = "1.0"
   acoef_function_3 = "1.0"
   bcoef_function_0 = "0.0"
   bcoef_function_1 = "0.0"
   bcoef_function_2 = "0.0"
   bcoef_function_3 = "0.0"
   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"
}

VelocityBcCoefs_1 {
   acoef_function_0 = "1.0"
   acoef_function_1 = "1.0"
   acoef_function_2 = "1.0"
   acoef_function_3 = "1.0"
   bcoef_function_0 = "0.0"
   bcoef_function_1 = "0.0"
   bcoef_function_2 = "0.0"
   bcoef_function_3 = "0.0"
   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"
}

AdvDiffHierarchyIntegrator {
   start_time = START_TIME
   end_time = END_TIME
   cfl = CFL_MAX
   dt_max = DT_MAX
   enable_logging = TRUE
   diffusion_time_stepping_type = "CRANK_NICOLSON"  // 2nd order in time
   convective_time_stepping_type = "ADAMS_BASHFORTH"

   HelmholtzHypreSolver {
      solver_type = "PFMG"
      relative_residual_tol = 1.0e-12
      max_iterations = 100
   }
}

// Initial condition: Gaussian with σ₀ = 0.5
OdorInitialConditions {
   function_0 = "exp(-(X_0*X_0 + X_1*X_1)/(2.0*0.5*0.5))"
}

// Far-field BCs: C=0 (domain large enough to approximate infinity)
OdorBcCoefs {
   acoef_function_0 = "1.0"
   acoef_function_1 = "1.0"
   acoef_function_2 = "1.0"
   acoef_function_3 = "1.0"
   bcoef_function_0 = "0.0"
   bcoef_function_1 = "0.0"
   bcoef_function_2 = "0.0"
   bcoef_function_3 = "0.0"
   gcoef_function_0 = "0.0"
   gcoef_function_1 = "0.0"
   gcoef_function_2 = "0.0"
   gcoef_function_3 = "0.0"
}

diffusion_coefficient = KAPPA
